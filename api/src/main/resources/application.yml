spring:
  application:
    name: Rubia Chat Server
  
  # Database Configuration
  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/rubia_chat}
    username: ${DATABASE_USERNAME:postgres}
    password: ${DATABASE_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver
  
  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: ${JPA_SHOW_SQL:false}
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: ${SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_TIME_ZONE:UTC}
  
  # Flyway Configuration
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
  
  # Disable Redis and RabbitMQ for now (uncomment to enable)
  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration,org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration
  
  # File Upload Configuration
  servlet:
    multipart:
      max-file-size: ${SPRING_SERVLET_MULTIPART_MAX_FILE_SIZE:20MB}
      max-request-size: ${SPRING_SERVLET_MULTIPART_MAX_REQUEST_SIZE:25MB}

# Server Configuration
server:
  port: ${SERVER_PORT:8080}

# JWT Configuration
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:86400000}

# Multi-tenant Configuration
company:
  domain: ${COMPANY_DOMAIN:rubia.localhost}

# CORS Configuration
cors:
  allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://*.rubia.localhost:3000}

# Messaging Configuration
messaging:
  provider: ${MESSAGING_PROVIDER:zapi}

# WhatsApp Provider Configuration
whatsapp:
  provider:
    account-id: ${WHATSAPP_ACCOUNT_ID:your_account_id}
    auth-token: ${WHATSAPP_AUTH_TOKEN:your_auth_token}
    phone-number: ${WHATSAPP_PHONE_NUMBER:+5511999999999}
    api-url: ${WHATSAPP_API_URL:https://api.twilio.com}

# Z-API Configuration
zapi:
  client-token: ${CLIENT_TOKEN}
  webhook:
    token: ${ZAPI_WEBHOOK_TOKEN:}
    base-url: ${Z_API_WEBHOOK_BASE_URL:https://your-domain.com}
  media:
    max-file-size: ${ZAPI_MEDIA_MAX_FILE_SIZE:20971520}
    allowed-types: ${ZAPI_MEDIA_ALLOWED_TYPES:image/jpeg,image/png,application/pdf,video/mp4,audio/mpeg}
  base-url: ${Z_API_BASE_URL:https://api.z-api.io}
  connection-monitor:
    enabled: ${Z_API_CONNECTION_MONITOR_ENABLED:true}
    check-interval: ${Z_API_CONNECTION_MONITOR_CHECK_INTERVAL:120000}
  timeouts:
    connection: ${ZAPI_CONNECTION_TIMEOUT:5000}
    read: ${ZAPI_READ_TIMEOUT:30000}
  retry:
    max-attempts: ${ZAPI_RETRY_MAX_ATTEMPTS:3}
    backoff-delay: ${ZAPI_RETRY_BACKOFF_DELAY:1000}

# Security Configuration
security:
  require-ssl: ${SECURITY_REQUIRE_SSL:false}

# Logging Configuration
logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:INFO}
    com.ruby: ${LOGGING_LEVEL_COM_RUBY:DEBUG}
    com.ruby.rubia_server.core.adapter.impl.ZApiAdapter: DEBUG
    com.ruby.rubia_server.core.service.MessagingService: DEBUG
    org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer: ERROR

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: "*"
    enabled-by-default: true
  endpoint:
    health:
      show-details: always
      enabled: true
    info:
      enabled: true

# Message Template Configuration
app:
  message-template:
    revision:
      fail-on-error: ${MESSAGE_TEMPLATE_REVISION_FAIL_ON_ERROR:true}