spring.application.name=Rubia Chat Server

# Server Configuration
server.port=${SERVER_PORT:8080}

# Database Configuration
spring.datasource.url=${DB_URL}

spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=${SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_TIME_ZONE:UTC}

# Flyway Configuration
spring.flyway.url=${DB_URL}
spring.flyway.user=${DB_USERNAME}
spring.flyway.password=${DB_PASSWORD}
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
logging.level.org.flywaydb=DEBUG
logging.level.com.zaxxer.hikari=DEBUG

# JWT Configuration
jwt.secret=${JWT_SECRET:mySecretKey123456789012345678901234567890}
jwt.expiration=${JWT_EXPIRATION:604800000}

# CORS Configuration
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://rubia.localhost:3000,https://7e8749e54dd0.ngrok-free.app,https://api.z-api.io}

spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.database=${REDIS_DATABASE:0}


# Messaging Configuration (global provider, per-user phone numbers)
messaging.provider=${MESSAGING_PROVIDER:zapi}

# Z-API Configuration
zapi.clientToken=${CLIENT_TOKEN}
zapi.media.max-file-size=${ZAPI_MEDIA_MAX_FILE_SIZE:20971520}
zapi.media.allowed-types=${ZAPI_MEDIA_ALLOWED_TYPES:image/jpeg,image/png,application/pdf,video/mp4,audio/mpeg}

# Z-API Connection Monitor Configuration
z-api.base-url=${Z_API_BASE_URL:https://api.z-api.io}
z-api.connection-monitor.enabled=${Z_API_CONNECTION_MONITOR_ENABLED:true}
z-api.connection-monitor.check-interval=${Z_API_CONNECTION_MONITOR_CHECK_INTERVAL:120000}
z-api.webhook.base-url=${Z_API_WEBHOOK_BASE_URL:https://your-domain.com}
zapi.webhook.token=${ZAPI_WEBHOOK_TOKEN:}

# Security Configuration
security.require-ssl=${SECURITY_REQUIRE_SSL:false}

# File Upload Configuration
spring.servlet.multipart.max-file-size=${SPRING_SERVLET_MULTIPART_MAX_FILE_SIZE:20MB}
spring.servlet.multipart.max-request-size=${SPRING_SERVLET_MULTIPART_MAX_REQUEST_SIZE:25MB}

# Logging Configuration
logging.level.root=${LOGGING_LEVEL_ROOT:INFO}
logging.level.com.ruby=${LOGGING_LEVEL_COM_RUBY:DEBUG}
logging.level.com.ruby.rubia_server.core.adapter.impl.ZApiAdapter=DEBUG
logging.level.com.ruby.rubia_server.core.service.MessagingService=DEBUG
logging.level.org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer=ERROR

# Actuator Configuration  
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.endpoints.enabled-by-default=true
management.endpoint.health.enabled=true
management.endpoint.info.enabled=true

# Message Template Configuration
app.message-template.revision.fail-on-error=${MESSAGE_TEMPLATE_REVISION_FAIL_ON_ERROR:true}

# Campaign Messaging Configuration (Otimizado para MVP - 25h para 1000 msgs)
campaign.messaging.batch-size=${CAMPAIGN_MESSAGING_BATCH_SIZE:30}
campaign.messaging.batch-pause-minutes=${CAMPAIGN_MESSAGING_BATCH_PAUSE_MINUTES:30}
campaign.messaging.min-delay-ms=${CAMPAIGN_MESSAGING_MIN_DELAY_MS:1000}
campaign.messaging.max-delay-ms=${CAMPAIGN_MESSAGING_MAX_DELAY_MS:3000}
campaign.messaging.message-timeout=${CAMPAIGN_MESSAGING_MESSAGE_TIMEOUT:PT30S}
campaign.messaging.batch-timeout=${CAMPAIGN_MESSAGING_BATCH_TIMEOUT:PT15M}
campaign.messaging.max-retries=${CAMPAIGN_MESSAGING_MAX_RETRIES:3}
campaign.messaging.retry-delay-ms=${CAMPAIGN_MESSAGING_RETRY_DELAY_MS:5000}
campaign.messaging.business-hours-only=${CAMPAIGN_MESSAGING_BUSINESS_HOURS_ONLY:true}
campaign.messaging.business-start-hour=${CAMPAIGN_MESSAGING_BUSINESS_START_HOUR:9}
campaign.messaging.business-end-hour=${CAMPAIGN_MESSAGING_BUSINESS_END_HOUR:23}
campaign.messaging.randomize-order=${CAMPAIGN_MESSAGING_RANDOMIZE_ORDER:true}

# Campaign Queue Configuration
campaign.queue.provider=${CAMPAIGN_QUEUE_PROVIDER:redis}

# AI Configuration - Optimized for Blood Donation Templates
spring.ai.openai.api-key=${OPENAI_API_KEY:your-openai-api-key-here}
ai.default-model=${AI_DEFAULT_MODEL:gpt-4o-mini}
ai.default-temperature=${AI_DEFAULT_TEMPERATURE:0.7}
ai.default-max-tokens=${AI_DEFAULT_MAX_TOKENS:150}

# Spring Boot Autoconfigure (disable RabbitMQ for now)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration

# Multi-tenant Configuration
company.domain=${COMPANY_DOMAIN:}

# WhatsApp Provider Configuration
whatsapp.provider.account-id=${WHATSAPP_ACCOUNT_ID:}
whatsapp.provider.auth-token=${WHATSAPP_AUTH_TOKEN:}
whatsapp.provider.phone-number=${WHATSAPP_PHONE_NUMBER:}
whatsapp.provider.api-url=${WHATSAPP_API_URL:}

# Z-API Extended Configuration
zapi.timeouts.connection=${ZAPI_CONNECTION_TIMEOUT:30000}
zapi.timeouts.read=${ZAPI_READ_TIMEOUT:60000}
zapi.retry.max-attempts=${ZAPI_RETRY_MAX_ATTEMPTS:3}
zapi.retry.backoff-delay=${ZAPI_RETRY_BACKOFF_DELAY:1000}


